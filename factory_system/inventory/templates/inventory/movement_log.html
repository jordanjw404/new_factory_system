{% extends "core/base.html" %}
{% block content %}

<h2>ðŸ“¦ Stock Movement Log</h2>
<p class="text-muted">Last 200 entries.</p>

<table class="table table-sm table-striped table-hover table-bordered text-center align-middle" id="movementTable">
  <thead class="table-dark">
    <tr>
      <th>Date</th><th>Item</th><th>Type</th><th>Qty</th><th>From</th><th>To</th><th>User</th><th>Reason</th>
    </tr>
  </thead>
  <tbody>
    {% for move in movements %}
    <tr>
      <td>{{ move.timestamp|date:"d M Y H:i" }}</td>
      <td>{{ move.item.code }}</td>
      <td><span class="badge bg-{{ move.move_type|lower }}">{{ move.get_move_type_display }}</span></td>
      <td>{{ move.quantity }}</td>
      <td>{% if move.from_location %}{{ move.from_location.name }}{% else %}â€”{% endif %}</td>
      <td>{% if move.to_location %}{{ move.to_location.name }}{% else %}â€”{% endif %}</td>
      <td>{{ move.user.username }}</td>
      <td>{{ move.reason|default:"â€”" }}</td>
    </tr>
    
    
    {% empty %}
    <tr><td colspan="8" class="text-muted text-center">No movements found.</td></tr>

    {% endfor %}
  </tbody>
</table>

<!-- Optional: DataTables -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">

<script>
  $(document).ready(function() {
      $('#movementTable').DataTable({
          order: [[0, 'desc']],
          pageLength: 25,
          language: {
              searchPlaceholder: "Search...",
              search: "",
              lengthMenu: "_MENU_ per page",
              paginate: { previous: "<", next: ">" }
          }
      });
  });
</script>

{% endblock %}
